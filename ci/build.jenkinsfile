library('common')

pipeline {
    agent {
        kubernetes {
            yaml k8sAgentConfig()
        }
    }
    options {
        buildDiscarder(logRotator(numToKeepStr: '30', artifactNumToKeepStr: '30'))
        withFolderProperties()
    }
    stages {
        stage('build project') {
            steps {
                script {
                    prepareEnv(env)
                    parallel buildModule(env)
                }
            }
        }
    }
}